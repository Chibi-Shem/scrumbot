<div class="container-fluid">
    <div class="row timesheets_container">
        <div class="col pt-5 pb-5 pl-5 pr-5 mt-2 ml-5">
            <div class="row pt-4 pb-4 justify-content-between">
                <div class="col d-flex flex-column">
                    <div class="d-flex flex-row align-items-center">
                        <span class="w-25 less-emphasis">Members</span>
                        <div class="input-group w-50">
                          <select class="custom-select less-emphasis" (change)="filter_user=select_user.value" #select_user>
                            <option selected value="">All Members</option>
                            <option *ngFor="let user of users">{{ user.username }}</option>
                          </select>
                        </div>
                    </div>
                </div>
                <div class="col d-flex flex-column">
                    <div class="d-flex flex-row-reverse align-items-center">
                            <div class="w-25 input-group date_filters">
                                <input class="form-control datepicker less-emphasis" ngx-mydatepicker name="to" [(ngModel)]="to_model" [options]="toOptions" #to_dp="ngx-mydatepicker" (dateChanged)="setDateToFilter($event)"/>
                                <span class="input-group-append">
                                    <button type="button" class="btn btn-light less-emphasis grey-border" (click)="to_dp.toggleCalendar()">
                                        <fa-icon [icon]="icons.calendar"></fa-icon>
                                    </button>
                                </span>
                            </div>
                            <h3 class="m-0 mr-2 ml-2 w-20px">-</h3>
                            <div class="w-25 input-group date_filters">
                                <input class="form-control datepicker less-emphasis" ngx-mydatepicker name="from" [(ngModel)]="from_model" [options]="fromOptions" #from_dp="ngx-mydatepicker" (dateChanged)="setDateFromFilter($event)"/>
                                <span class="input-group-append">
                                    <button type="button" class="btn btn-light  less-emphasis grey-border" (click)="from_dp.toggleCalendar()">
                                        <fa-icon [icon]="icons.calendar"></fa-icon>
                                    </button>
                                </span>
                            </div>
                        <span class="less-emphasis mr-4">Date</span>
                    </div>
                </div>
            </div>
            <div class="row pt-4 ">
                <div class="col-sm-12 d-flex justify-content-between">
                    <h4 class="font-bold">Timesheet list</h4>
                </div>
            </div>
            <div class="row mt-3 d-flex">
                <div class="offset-4 col-2">
                    <span class="category_label font-bold">Time in</span>
                </div>
                <div class="offset-1 col-2">
                    <span class="category_label font-bold">Time out</span>
                </div>
                <div class="offset-1 col-2">
                    <span class="category_label font-bold">Hours logged</span>
                </div>
            </div>
            <div class="mb-4" *ngFor="let date_group of filtered_timesheets | groupTimesheets:'time_in' ">
                <div *ngIf="isWithinDate(date_group.date, filter_from, filter_to) && filteredExists(date_group.timesheets)">
                    <div class="row mb-3">
                        <div class="col-sm-2 d-flex">
                            <span class="align-self-center grey-border less-emphasis">{{ returnToDisplayHumanizeTime(date_group)}}{{ date_group.date | date:'longDate'}}</span>
                        </div>
                        <div class="col-sm-10">
                            <hr>
                        </div>
                    </div>
                    <div class="d-flex flex-column m-0 scrumlist">
                        <div *ngFor="let timesheet of date_group.timesheets">
                            <div *ngIf="(filter_user=='' || timesheet.user_username==filter_user) && isWithinDate(timesheet.time_in, filter_from, filter_to)" class="d-flex align-items-center scrumitem mt-1 mb-1">
                                <div class="d-flex flex-fill align-items-center" >
                                    <div class="col-3 d-flex mr-0">
                                        <div class="pt-2">
                                            <app-avatar [username]="timesheet.user_username" [id]="timesheet.user_username"></app-avatar>
                                        </div>
                                        <div class="ml-3 pt-2 w-75">
                                            <p class=" mb-0 pb-0 user text-truncate w-100 font-lato-16-height-19">{{ timesheet.user_username }}</p>
                                            <span class="less-emphasis category_label mt-0 pt-0">{{ timesheet.time_in | date:'shortTime'}} </span>
                                        </div>
                                    </div>
                                    <div class="col-3 offset-1 d-flex p-0 align-items-center">
                                        <div class="d-inline-block timesheet_box text-truncate">
                                            <p class="less-emphasis inital-truncate mt-2 text-truncate font-lato-16-height-19">{{ timesheet.time_in | date:'shortTime' }}</p>
                                        </div>
                                         <p *ngIf="timesheet.is_late" class="urgent m-0 pt-1 pl-1 pr-1 ml-4 rounded-left rounded-right pb-0">Late</p>
                                    </div>
                                    <div class="col-2 offset-1 d-flex p-0 align-items-center">
                                        <div class="d-inline-block timesheet_box text-truncate">
                                            <p class="less-emphasis inital-truncate mt-2 text-truncate font-lato-16-height-19">{{ timesheet.time_out | date:'shortTime' }}</p>
                                        </div>
                                    </div>
                                    <div class="col-3 offset-1 d-flex p-0 align-items-center">
                                        <div class="d-inline-block timesheet_box text-truncate">
                                            <p class="less-emphasis inital-truncate mt-2 text-truncate font-lato-16-height-19">{{ timesheet.hours }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>